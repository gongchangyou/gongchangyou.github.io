I"ß<h1 id="spring-cloud-alibaba---nacos-4-è´Ÿè½½å‡è¡¡">Spring Cloud Alibaba - nacos 4 è´Ÿè½½å‡è¡¡</h1>

<ol>
  <li>åˆ›å»ºä¸¤ä¸ªä¸åŒç«¯å£çš„ producer 
	```
	package com.braindata.dubbodemo.config;</li>
</ol>

<p>import java.util.Map;
import java.util.Map.Entry;
import javax.annotation.PostConstruct;</p>

<p>import org.apache.dubbo.common.utils.NetUtils;
import org.apache.dubbo.config.ProtocolConfig;
import org.springframework.beans.BeansException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.stereotype.Component;</p>

<p>/**</p>
<ul>
  <li>ä¸€ä¸ªæœºå™¨éƒ¨ç½²ä¸¤ä¸ªdubboç”Ÿäº§è€…ä¼šäº§ç”Ÿç«¯å£å ç”¨é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨åŠ è½½dubboé…ç½®æ–‡ä»¶ä¹‹å‰ï¼Œå…ˆè®¾ç½®æ²¡è¢«å ç”¨çš„ç«¯å£</li>
  <li>
    <p>@author cookie
 */
@Component
public class DynamicDubboPortReader implements ApplicationContextAware{
 @Autowired
 private ApplicationContext applicationContext;</p>

    <p>private int port = 20880;</p>

    <p>@PostConstruct
 public void init(){
     Map&lt;String, ProtocolConfig&gt; map = applicationContext.getBeansOfType(ProtocolConfig.class);
     for(Entry&lt;String,ProtocolConfig&gt; con: map.entrySet()){
         port = NetUtils.getAvailablePort();
         System.out.println(â€œ==========â€+port);
         con.getValue().setPort(port);
     }
 }</p>

    <p>@Override
 public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
     this.applicationContext = (ConfigurableApplicationContext)applicationContext;
 }</p>
  </li>
</ul>

<p>}</p>

   	```
:ET